const modal=function(){const e=document.querySelector(".overlay");document.body.addEventListener("click",function(t){const n=t.target;if("modal"in n.dataset){const t=document.querySelector(`#${n.dataset.modal}`);"order"===n.dataset.modal&&(t.querySelector(".modal__descr").innerHTML=n.closest(".catalog-item").querySelector(".catalog-item__subtitle").innerHTML),fadeIn(e,20),fadeIn(t,20)}n.classList.contains("modal__close")&&(fadeOut(e,40),fadeOut(n.closest(".modal"),40))});modalValidation("form.feed-form",{rules:{name:{required:!0,minLength:5,maxLength:10},email:{required:!0,email:!0},phone:{required:!0,phone:!0}},messages:{name:{required:"Поле обязательно для заполнения",minLength:"Введите не менее {0} символов",maxLength:"Введите не более {0} символов"},email:{required:"Поле обязательно для заполнения",email:"Введите правильный адрес почты"},phone:{required:"Поле обязательно для заполнения",phone:"Введите правильный номер телефона"}}})},validationCheckMap={required:e=>""===e,minLength:(e,t)=>e.length<t,maxLength:(e,t)=>e.length>t,phone(e){const t=e.match(/\d/g);return null===t||t.length<11},email:e=>!1===/\S+?@\S+?\.\S+/.test(e)},validationCheckError=function(e,t){const n=e.nextElementSibling;let a=!1;const o=e.getAttribute("name"),c=t.rules[o];for(const s in c){const r=c[s],l=t.messages[o][s];if(a=validationCheckMap[s](e.value,r)){n&&n.classList.contains("error-msg")&&(n.remove(),e.classList.remove("error"));const t=document.createElement("div");t.className="error-msg",t.textContent=l.replace("{0}",r),e.classList.add("error"),e.after(t);break}}return!a&&n.classList.contains("error-msg")&&(n.remove(),e.classList.remove("error")),a},modalValidation=function(e,t){document.addEventListener("blur",function(n){n.target.matches&&n.target.matches("input")&&n.target.closest("form").matches(e)&&validationCheckError(n.target,t)},!0),document.addEventListener("submit",function(n){const a=n.target.closest("form");if(!a.matches(e))return;const o=a.querySelectorAll("input");for(const e of o){const a=e.getAttribute("name"),o=validationCheckError(e,t);t.rules[a].required&&o&&n.preventDefault()}},!0)};modal(),document.addEventListener("DOMContentLoaded",function(e){sliderTNS()});const sliderTNS=function(){const e=tns({container:".carousel__inner",items:1,slideBy:"page",autoplay:!1,controls:!1,nav:!1,navPosition:"bottom",center:!0,responsive:{992:{nav:!1},320:{touch:!0,nav:!0}}});document.querySelector(".carousel .prev").addEventListener("click",function(){e.goTo("prev")}),document.querySelector(".carousel .next").addEventListener("click",function(){e.goTo("next")})},tabs=document.querySelectorAll(".catalog .catalog__content");document.querySelector("ul.catalog__tabs").addEventListener("click",function(e){document.querySelector(".catalog .catalog__tab_active").classList.remove("catalog__tab_active");const t=e.target.closest("li");t.classList.add("catalog__tab_active"),document.querySelector(".catalog .catalog__content_active").classList.remove("catalog__content_active");const n=t.dataset.index;tabs[n].classList.add("catalog__content_active")}),document.querySelector(".catalog").addEventListener("click",function(e){if(e.target.matches("a.catalog-item__link")||e.target.matches("a.catalog-item__back")){e.preventDefault();const t=e.target.closest(".catalog-item__wrapper").children;t[0].classList.toggle("catalog-item__content_active"),t[1].classList.toggle("catalog-item__list_active")}});const fadeIn=function(e,t){if(t>0){const n=e.style.opacity||1;e.style.opacity=0,e.style.display="";const a=setInterval(function(){e.style.opacity<n?e.style.opacity=parseFloat(e.style.opacity)+.2:(e.style.opacity="",clearInterval(a))},t)}else e.style.display=""},fadeOut=function(e,t){if(t>0){const n=e.style.opacity;e.style.opacity=1;const a=setInterval(function(){e.style.opacity>0?e.style.opacity=parseFloat(e.style.opacity)-.2:(clearInterval(a),e.style.display="none",e.style.opacity=n)},t)}else e.style.display="none"};document.addEventListener("submit",async function(e){const t=e.target.closest("form");t.matches("form.feed-form")&&!e.defaultPrevented&&(e.preventDefault(),fadeOut(t.closest(".modal")),(await fetch("mailer/smart.php",{method:"POST",body:new FormData(t)})).ok?(t.reset(),fadeIn(document.querySelector("#thanks"),20)):(alert("Упс, попробуйте еще раз"),fadeIn(t.closest(".modal"),20)))},!0),document.addEventListener("scroll",function(){const e=100*window.pageYOffset/(document.documentElement.scrollHeight-document.documentElement.clientHeight),t=document.querySelector(".page-up");e>40?fadeIn(t):fadeOut(t)}),document.addEventListener("click",function(e){if(!e.target)return;const t=e.target.closest("a");if(!t)return;const n=t.getAttribute("href");if(n&&n.startsWith("#")&"#"!==n){e.preventDefault();let t=document.querySelector(n).getBoundingClientRect().top;const a=t<0;a||(t+=document.documentElement.clientHeight);let o,c=0;o=a?-50:50;const s=setInterval(function(){c>t&&a||c<t&&!a?(document.documentElement.scrollBy(0,o),c+=o):clearInterval(s)},10)}});